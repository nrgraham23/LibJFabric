# Java
JAVA_SOURCES = \
	../../../../java/org/ofi/libfab_java_bindings/HelloJNI.java 

#above and below is a \ separated list

JNI_CLASSES = \
	org.ofi.libfab_java_bindings.HelloJNI

#
# Maven sets JAVA_HOME aka java.home to ${JAVA_HOME}/jre wow !!! need to add a funky include for this.
#

CFLAGS=-g -I${JAVA_HOME}/include -I${JAVA_HOME}/include/darwin

LDFLAGS=-ldl

all: libhello.so

libhello.so: org_ofi_libfab_java_bindings_HelloJNI.h HelloJNI.o
	gcc ${CFLAGS} -shared HelloJNI.o -o libhello.so  ${LDFLAGS}

HelloJNI.o: HelloJNI.c
	gcc -c ${CFLAGS} HelloJNI.c

org_ofi_libfab_java_bindings_HelloJNI.h: ${JAVA_SOURCES}
	javac ${JAVA_SOURCES}
	javah ${JNI_CLASSES}

clean:
	rm -f *.class *.o
	rm -f libhello.so
	rm -f org_*.h

#test:
#	javac -g -Xlint:deprecation -classpath ${CLASSPATH} Test.java